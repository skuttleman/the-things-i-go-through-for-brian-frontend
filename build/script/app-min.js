function login(e){e&&e.preventDefault(),displayTemplate("main","loginform",{postMethod:"loginPost",postText:"Log In",switchMethod:"signup",switchText:"Sign Up"})}function loginPost(e){e&&e.preventDefault();var o=createFormData("form");$.ajax({url:appvars.server+"login",method:"post",data:o,xhrFields:{withCredentials:!0}}).done(function(e){console.log(e),listData(),displayHeader()}).fail(function(e){console.error(e)})}function signup(e){e&&e.preventDefault(),displayTemplate("main","loginform",{postMethod:"signupPost",postText:"Sign Up",switchMethod:"login",switchText:"Log In"})}function signupPost(e){e&&e.preventDefault();var o=createFormData("form");$.ajax({url:appvars.server+"signup",method:"post",data:o,xhrFields:{withCredentials:!0}}).done(function(e){console.log(e),listData()}).fail(function(e){console.error(e)})}function logout(e){e&&e.preventDefault(),$.ajax({url:appvars.server+"logout",method:"post",xhrFields:{withCredentials:!0}}).done(function(e){console.log(e),displayHeader(),listData()}).fail(function(e){console.error(e)})}function createFormData(e){return Array.prototype.reduce.call($(e).children(),function(e,o){return"INPUT"==o.tagName&&(e[o.name]=o.value),e},{})}function promisifyPartial(e){return new Promise(function(o,t){$.get(e.file).done(function(t){Handlebars.registerPartial(e.name,t),o(!0)}).fail(function(e){t(e)})})}function promiseToLoad(){return new Promise(function(e){$(document).ready(function(){e()})})}function displayTemplate(e,o,t){var a=!!decodeURIComponent(document.cookie).split("user=s:")[1],r=Handlebars.compile(Handlebars.partials[o]);t.signedIn=a,$(e).html(r(t))}function pageLoaded(e){displayHeader(),list(e)}function list(e){e.broncos.forEach(function(e){e.heightString=String(Math.floor(e.height/12))+"'"+String(e.height%12)+"''"}),displayTemplate("main","broncos",{broncos:e.broncos})}function listData(){$.ajax({url:appvars.server+"broncos",method:"get"}).done(list)}function displayHeader(){displayTemplate("header","header",{})}function addPlayer(){displayTemplate("main","playerform",{postMethod:"addPlayerPost",postText:"Add Player"})}function addPlayerPost(e){e&&e.preventDefault();var o=createFormData("form");$.ajax({url:appvars.server+"broncos",method:"post",data:o,xhrFields:{withCredentials:!0}}).done(function(e){console.log(e),listData()}).fail(function(e){console.error(e)})}function editPlayer(e){$.ajax({url:appvars.server+"broncos/"+e,method:"get"}).done(function(o){var t=o.broncos[0];t.postMethod="editPut",t.postText="Update Player",t.params=e,displayTemplate("main","playerform",t)}).fail(function(e){console.error(e)})}function editPut(e,o){e&&e.preventDefault();var t=createFormData("form");$.ajax({url:appvars.server+"broncos/"+o,method:"put",data:t,xhrFields:{withCredentials:!0}}).done(function(e){console.log(e),listData()}).fail(function(e){console.error(e)})}function deletePlayer(e){$.ajax({url:appvars.server+"broncos/"+e,method:"delete",xhrFields:{withCredentials:!0}}).done(function(e){console.log(e),listData(),displayHeader()}).fail(function(e){console.error(e)})}function cancel(e){e&&e.preventDefault(),listData()}var appvars={server:"http://localhost:8000/"};Promise.all([$.ajax({url:appvars.server+"broncos",method:"get"}),promisifyPartial({name:"header",file:"/templates/header.hbs"}),promisifyPartial({name:"broncos",file:"/templates/broncos.hbs"}),promisifyPartial({name:"loginform",file:"/templates/login-form.hbs"}),promisifyPartial({name:"playerform",file:"/templates/player-form.hbs"}),promiseToLoad()]).then(function(e){pageLoaded(e[0])}),Handlebars.registerHelper("compare",function(e,o,t){return e==o?t.fn(this):t.inverse(this)});